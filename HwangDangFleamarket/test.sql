select * FROM admin_QnA 
ORDER BY admin_qna_no DESC;

SELECT count(*) FROM  admin_qna


select * FROM member;

INSERT INTO ADMIN_QNA  VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목1'  ,'임시글내용ABC1' ,'scott12','2015-02-12' ,0 , 't');
INSERT INTO ADMIN_QNA VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목2'  ,'임시글내용ABC12' ,'scott12','2015-02-11',0 , 't');
INSERT INTO ADMIN_QNA VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목3'  ,'임시글내용ABC123' ,'scott123','2015-02-04',0 , 'f');
INSERT INTO ADMIN_QNA VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목4'  ,'임시글내용ABC1234' ,'scott124','2015-02-02',0 , 't');
INSERT INTO ADMIN_QNA  VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목1'  ,'임시글내용ABC1' ,'scott12','2015-02-12',0 , 't');
INSERT INTO ADMIN_QNA VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목2'  ,'임시글내용ABC12' ,'scott12','2015-02-11',0 , 't');
INSERT INTO ADMIN_QNA VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목3'  ,'임시글내용ABC123' ,'scott123','2015-02-04',0 , 'f');
INSERT INTO ADMIN_QNA VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목4'  ,'임시글내용ABC1234' ,'scott124','2015-02-02',0 , 't');
INSERT INTO ADMIN_QNA  VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목1'  ,'임시글내용ABC1' ,'scott12','2015-02-12',0 , 't');
INSERT INTO ADMIN_QNA VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목2'  ,'임시글내용ABC12' ,'scott12','2015-02-11',0 , 't');
INSERT INTO ADMIN_QNA VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목3'  ,'임시글내용ABC123' ,'scott123','2015-02-04',0 , 'f');
INSERT INTO ADMIN_QNA VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목4'  ,'임시글내용ABC1234' ,'scott124','2015-02-02',0 , 't');
INSERT INTO ADMIN_QNA  VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목1'  ,'임시글내용ABC1' ,'scott12','2015-02-12',0 , 't');
INSERT INTO ADMIN_QNA VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목2'  ,'임시글내용ABC12' ,'scott12','2015-02-11',0 , 't');
INSERT INTO ADMIN_QNA VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목3'  ,'임시글내용ABC123' ,'scott123','2015-02-04',0 , 'f');
INSERT INTO ADMIN_QNA VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목4'  ,'임시글내용ABC1234' ,'scott124','2015-02-02',0 , 't');
INSERT INTO ADMIN_QNA  VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목1'  ,'임시글내용ABC1' ,'scott12','2015-02-12',0 , 't');
INSERT INTO ADMIN_QNA VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목2'  ,'임시글내용ABC12' ,'scott12','2015-02-11',0 , 't');
INSERT INTO ADMIN_QNA VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목3'  ,'임시글내용ABC123' ,'scott123','2015-02-04',0 , 'f');
INSERT INTO ADMIN_QNA VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목4'  ,'임시글내용ABC1234' ,'scott124','2015-02-02',0 , 't');
INSERT INTO ADMIN_QNA  VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목1'  ,'임시글내용ABC1' ,'scott12','2015-02-12',0 , 't');
INSERT INTO ADMIN_QNA VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목2'  ,'임시글내용ABC12' ,'scott12','2015-02-11',0 , 't');
INSERT INTO ADMIN_QNA VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목3'  ,'임시글내용ABC123' ,'scott123','2015-02-04',0 , 'f');
INSERT INTO ADMIN_QNA VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목4'  ,'임시글내용ABC1234' ,'scott124','2015-02-02',0 , 't');
INSERT INTO ADMIN_QNA  VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목1'  ,'임시글내용ABC1' ,'scott12','2015-02-12',0 , 't');
INSERT INTO ADMIN_QNA VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목2'  ,'임시글내용ABC12' ,'scott12','2015-02-11',0 , 't');
INSERT INTO ADMIN_QNA VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목3'  ,'임시글내용ABC123' ,'scott123','2015-02-04',0 , 'f');
INSERT INTO ADMIN_QNA VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목4'  ,'임시글내용ABC1234' ,'scott124','2015-02-02',0 , 't');
INSERT INTO ADMIN_QNA  VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목1'  ,'임시글내용ABC1' ,'scott12','2015-02-12',0 , 't');
INSERT INTO ADMIN_QNA VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목2'  ,'임시글내용ABC12' ,'scott12','2015-02-11',0 , 't');
INSERT INTO ADMIN_QNA VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목3'  ,'임시글내용ABC123' ,'scott123','2015-02-04',0 , 'f');
INSERT INTO ADMIN_QNA VALUES(  admin_qna_no_seq.nextval ,'임시QnA제목4'  ,'임시글내용ABC1234' ,'scott124','2015-02-02',0 , 't');

/*테이블 스키마 수정 */
ALTER TABLE admin_QnA ADD admin_qna_reply number;
ALTER TABLE admin_QnA drop column  admin_qna_reply;


CREATE TABLE admin_QnA_reply (
	admin_reply_no NUMBER primary key, /* 댓글번호 */
	admin_reply_content varchar2(4000) NOT NULL, /* 내용 */
	admin_reply_date DATE NOT NULL, /* 작성일 */
	admin_reply_writer VARCHAR2(30) NOT NULL, /* 작성자 */
	admin_qna_no NUMBER not null, /* 관리자QnA no */
	
	foreign key(admin_qna_no) references admin_qna(admin_qna_no) on delete cascade

select * FROM  admin_QnA_reply
	
INSERT INTO admin_QnA_reply
VALUES(
	 admin_reply_no_seq.nextval , 
	'abc', 
	'2010-10-10',
	'관리자' , 
	  44
);

-- 조인 테스트 
SELECT  	q.admin_qna_no ,
			q.admin_qna_title ,
			q.admin_qna_content ,
			q.admin_qna_writer ,
			q.admin_qna_date ,
			q.admin_qna_hit ,
			q.admin_qna_published, 
			r.admin_reply_content ,
			r.admin_reply_date
			
		FROM  ADMIN_QNA q  ,  admin_QnA_reply r
		WHERE q.admin_qna_no = 23 
		AND  q.admin_qna_no =  r.admin_qna_no(+) 

		
		DELETE FROM admin_qna_reply 
		WHERE admin_reply_no =  59
		
		
		DELETE FROM admin_qna_reply 
		WHERE admin_qna_no = 55;
		

		select * FROM  admin_QnA_reply 
		WHERE  admin_qna_no = 20;
		
		
select * FROM department
select * FROM employee

select * FROM member 


-- 집에 db추가 
/* 소식통(판매자) */
CREATE TABLE seller_notice (
	seller_notice_no NUMBER NOT NULL, /* 소식글 no */
	seller_notice_title VARCHAR2(300) NOT NULL, /* 소식글 제목 */
	seller_notice_content CLOB NOT NULL, /* 소식글 내용 */
	seller_notice_date DATE NOT NULL, /* 소식글 작성일 */
	seller_notice_hit NUMBER NOT NULL, /* 소식글 조회수 */
	seller_store_no number not null,/* 판매자 스토어 번호 */
	foreign key (seller_store_no) references seller(seller_store_no) on delete cascade
);

create sequence seller_notice_no_seq nocache;



/* 회원 */
DROP TABLE member 
	CASCADE CONSTRAINTS;

/* 판매자 */
DROP TABLE seller 
	CASCADE CONSTRAINTS;
	
/* 회원vvvvvvvvvvvv*/
CREATE TABLE member (
	member_id VARCHAR2(30) primary key, /* 아이디 */
	member_password VARCHAR2(20) NOT NULL, /* 비밀번호 */
	member_name VARCHAR2(18) NOT NULL, /* 이름 */
	member_phone CHAR(13) NOT NULL, /* 전화번호 */
	member_zipcode VARCHAR2(7) NOT NULL, /* 우편번호 */
	member_address VARCHAR2(180) NOT NULL, /* 주소 */
	member_sub_address VARCHAR2(90) NOT NULL, /* 세부주소 */
	member_assign NUMBER(1) NOT NULL /* 판매자등록여부 */
);
ALTER TABLE member RENAME COLUMN member_sub_adress to member_sub_address;

insert into member values ('isj4216', '52545856', '이성준', '010-9977-2905', '123-456',
										   '경기도 성남시 분당구 야탑동.', '노블리치오피스텔 A동 513호', 0);
insert into member values ('lsj4216', '52545856', '판매자', '010-9977-2905', '123-456',
   										   '경기도 성남시 분당구 야탑동.', '노블리치오피스텔 B동 313호', 1);
insert into member values ('hwang', 'dangdang', '황경희매니저', '010-9977-2905', '123-456',
   										   '경기도 성남시 판교동 판교로.', '유스페이스 B동 8층', 1);
insert into member values ('lsj42167', '52545856', '판매자', '010-9977-2905', '123-456',
   										   '경기도 성남시 분당구 야탑동.', '노블리치오피스텔 B동 313호', 1);
insert into member values ('lsj421678', 'dangdang', '황경희매니저', '010-9977-2905', '123-456',
   										   '경기도 성남시 판교동 판교로.', '유스페이스 B동 8층', 1); 
insert into member values ('hwanghwang', 'dangdang', '황경희매니저', '010-9977-2905', '123-466',
   										   '경기도 성남시 판교동 판교로.', '유스페이스 B동 7층', 1);
   						
   										   
insert into member values ('hwang@naver.com','dangdang', '황경희', '010-2387-0073','456-888','경기도 안산시 상록구','어디동 21번지',1) 

insert into member values ('kinghwang', 'kingdang', '퐝경', '010-9977-2905', '123-466',
   										   '경기도 성남시 판교동 판교로.', '유스페이스 B동 7층', 0);
   										   
insert into member values ('hwang3', 'dangdang', '황경희매니저', '010-9977-2905', '123-466',
   										   '경기도 성남시 판교동 판교로.', '유스페이스 B동 7층', 1);


   										   
   										   
/* 판매자vvvvvvvvvvv */
CREATE TABLE seller (
	seller_store_no number not null unique,
	seller_store_name VARCHAR2(60) not null unique, /* 상호명 */
	seller_tax_id CHAR(11), /* 사업자번호 */
	seller_industry VARCHAR2(30) NOT NULL, /* 업종 */
	seller_sub_industry VARCHAR2(150), /* 업종 소분류 */
	seller_zipcode VARCHAR2(7) NOT NULL, /* 우편번호 */
	seller_address VARCHAR2(180) NOT NULL, /* 주소 */
	seller_sub_address VARCHAR2(90) NOT NULL, /* 세부주소 */
	seller_store_image VARCHAR2(90) NOT NULL, /* 대표사진 */
	seller_product1 VARCHAR2(30), /* 판매물품1 */
	seller_product2 VARCHAR2(30), /* 판매물품2 */
	seller_product3 VARCHAR2(30), /* 판매물품3 */
	seller_introduction VARCHAR2(4000) NOT NULL, /* 소개글 */
	seller_assign number(1) not null,
	member_id varchar2(30) not null,
	foreign key(member_id) references member(member_id) on delete cascade
);
drop sequence seller_store_no_seq
create sequence seller_store_no_seq nocache;

insert into seller values(seller_store_no_seq.nextval, '해물나라', '12345-67890', '대분류업종', '소분류업종', '123-456', 
							'경기도 성남시 분당구 야탑동.', '노블리치오피스텔 B동 313호', '해물찜', '#전복', '#냉동문어', '#낙지', 
							'아주아주 싱싱하고 맛있는 해산물을 산지직송해드립니다.',1, 'hwang');
insert into seller values(seller_store_no_seq.nextval, '통영대표꿀빵', '12345-66789', '대분류업종', '소분류업종', '123-654', 
							'경기도 성남시 분당구 삼평동.', '유스페이스 B동 313호', '꿀빵', '#원조꿀빵', '#유자꿀빵', '#고구마꿀빵', 
							'넘나 맛있는 꿀빵을 만드는 꿀빵집입니다.',1, 'hwanghwang');
							
insert into seller values(seller_store_no_seq.nextval, '매머드', '12345-66789', '대분류업종', '소분류업종', '123-654', 
							'경기도 성남시 분당구 삼평동.', '유스페이스 B동 313호', '꿀빵', '#빅커피', '#꿀라떼', '#고구마라떼', 
							'넘나 맛있는 커피를 만드는 카페입니다.',0, 'hwang3'); 
   		
SELECT admin_qna_no_seq.nextval 
FROM dual
select * FROM admin_QnA 
ORDER BY admin_qna_no DESC;


--페이징
select * FROM (
SELECT admin_qna_no , admin_qna_title , admin_qna_content , admin_qna_writer ,
	   admin_qna_date , admin_qna_hit , admin_qna_published ,admin_qna_password ,
	   ceil(rownum / 10) page
FROM (
	SELECT    rownum , admin_qna_no , admin_qna_title , admin_qna_content ,admin_qna_writer ,
			  admin_qna_date ,admin_qna_hit ,admin_qna_published , admin_qna_password 
	FROM      ADMIN_QNA
	ORDER BY  admin_qna_no DESC
	) 
	)WHERE page = 1
			
		
SELECT      q.admin_qna_no ,q.admin_qna_title ,q.admin_qna_content ,
			q.admin_qna_writer ,q.admin_qna_date ,q.admin_qna_hit ,
			q.admin_qna_published, q.admin_QnA_password ,
			r.admin_reply_content ,r.admin_reply_date , r.admin_reply_no	
FROM        ADMIN_QNA q  ,  admin_QnA_reply r
WHERE       q.admin_qna_no =  r.admin_qna_no(+) 
	  
SELECT * FROM admin_QnA



--QnA게시판 답변여부 컬럼추가 
ALTER TABLE admin_QnA ADD admin_QnA_reply_exist char(1)
ALTER TABLE admin_QnA DROP COLUMN  admin_QnA_reply_exist 


DROP TABLE orders 
	CASCADE CONSTRAINTS;


CREATE TABLE orders (
	orders_no VARCHAR2(10) primary key, /* 주문번호 */
	orders_receiver VARCHAR2(18) NOT NULL, /* 받는사람 */
	orders_phone CHAR(13) NOT NULL, /* 전화번호 */
	orders_zipcode VARCHAR2(7) NOT NULL, /* 우편번호 */
	orders_address VARCHAR2(180) NOT NULL, /* 주소 */
	orders_sub_address VARCHAR2(90) NOT NULL, /* 세부주소 */
	orders_total_price NUMBER NOT NULL, /* 총주문가격 */
	orders_payment VARCHAR2(21) NOT NULL, /* 결제방식 */
	orders_request VARCHAR2(51), /* 요청사항 */
	payment_status NUMBER(1) NOT NULL, /* 결제여부 */
	orders_status VARCHAR2(15) NOT NULL, /* 주문현황 */
	member_id VARCHAR2(30) NOT NULL,/* 구매자 ID */
	foreign key(member_id) references member(member_id) 
);
ALTER TABLE orders MODIFY  orders_status number(1);



--주문TB
insert into orders values ('order_no43', '홍길동1', '010-123-1234', '850-123', '경기도 성남시 분당구 판교동 주소', '유스스페이스 200-1동 303호 세부주소', 30000, '카드', '부재중일시 경비실에 맡겨주세요', 1, 0, 'admin@admin.com' );
insert into orders values ('order_no17', '홍길동2', '010-123-1234', '850-123', '경기도 성남시 분당구 판교동 주소', '유스스페이스 200-1동 303호 세부주소', 20000, '카드', '부재중일시 경비실에 맡겨주세요', 2, 1, 'admin@admin.com' );
insert into orders values ('order_no37', '홍길동3', '010-123-1234', '850-123', '경기도 성남시 분당구 판교동 주소', '유스스페이스 200-1동 303호 세부주소', 50000, '카드', '부재중일시 경비실에 맡겨주세요', 3, 2, 'admin@admin.com' );
insert into orders values ('order_no28', '홍길동4', '010-123-1234', '850-123', '경기도 성남시 분당구 판교동 주소', '유스스페이스 200-1동 303호 세부주소', 10000, '카드', '부재중일시 경비실에 맡겨주세요', 4, 3, 'admin@admin.com' );
insert into orders values ('order_no13', '홍길동5', '010-123-1234', '850-123', '경기도 성남시 분당구 판교동 주소', '유스스페이스 200-1동 303호 세부주소', 340000, '카드', '부재중일시 경비실에 맡겨주세요', 1, 4, 'admin@admin.com' );
insert into orders values ('order_no11', '홍길동6', '010-123-1234', '850-123', '경기도 성남시 분당구 판교동 주소', '유스스페이스 200-1동 303호 세부주소', 340000, '카드', '부재중일시 경비실에 맡겨주세요', 1, 5, 'admin@admin.com');
insert into orders values ('order_no42', '홍길동7', '010-123-1234', '850-123', '경기도 성남시 분당구 판교동 주소', '유스스페이스 200-1동 303호 세부주소', 30000, '카드', '부재중일시 경비실에 맡겨주세요', 1, 6, 'admin@admin.com' );
insert into orders values ('order_no34', '홍길동8', '010-123-1234', '850-123', '경기도 성남시 분당구 판교동 주소', '유스스페이스 200-1동 303호 세부주소', 20000, '카드', '부재중일시 경비실에 맡겨주세요', 2, 7, 'admin@admin.com' );

drop table order_product
create sequence order_product_seq nocache;
CREATE TABLE order_product  (
	order_seq_no number primary key ,  -- PK 
	order_amount number(4) not null, /* 상품수량  */
	orders_no VARCHAR2(10) not null, /* 주문번호 FK */
	product_id VARCHAR2(30) not null, /* 상품ID FK */
	option_id number not null ,      --  상품옵션ID_FK  
	seller_store_no number not null,     -- 판매자스토어NO_FK
	foreign key(orders_no) references orders(orders_no) on delete cascade,
	foreign key(product_id) references product(product_id) on delete set null ,
	foreign key(option_id) references product_option(option_id) on delete set null ,
	foreign key(seller_store_no) references seller(seller_store_no) on delete set null
);

-- 주문상품 TB                           //PK              주문수량  , 주문번호  , 상품ID   , 상품옵션 ,  판매자스토어NO          
insert into order_product values (order_product_seq.nextval , 5, 'order_no43', '상품id1', 12 , 15 );
insert into order_product values (order_product_seq.nextval ,4, 'order_no17', '상품id2', 13, 15 );
insert into order_product values (order_product_seq.nextval ,4, 'order_no37', '상품id3', 14, 15 );
insert into order_product values (order_product_seq.nextval ,1, 'order_no28', '상품id4', 15, 16);
insert into order_product values (order_product_seq.nextval ,2, 'order_no13', '상품id5', 16, 16);
insert into order_product values (order_product_seq.nextval ,1, 'order_no11', '상품id6', 17, 16);
insert into order_product values (order_product_seq.nextval , 1, 'order_no42', '상품id7', 18, 17);
insert into order_product values (order_product_seq.nextval ,4, 'order_no34', '상품id1', 12, 17);



--제품TB
                       --  상품아이디   상품명           가격     재고량     메인사진 ,  (상세사진)    상품정보     추천수    , 스토어번호  
insert into product values ('상품id1', '새우깡', 50000, 10, 'abc1.jpg', '상품정보1', 1, 15);
insert into product values ('상품id2', '부여사과', 60000, 20, 'abc2.jpg', '상품정보2', 3, 15);
insert into product values ('상품id3', '금산인삼', 70000, 30, 'abc3.jpg', '상품정보3', 2, 17);
insert into product values ('상품id4', '북한냉면', 80000, 40, 'abc4.jpg', '상품정보4', 6, 16);
insert into product values ('상품id5', '여수밤바다', 30000, 50, 'abc5.jpg', '상품정보5', 7, 16);
insert into product values ('상품id6', '금사빠', 20000, 60, 'abc6.jpg', '상품정보6', 2, 16);
insert into product values ('상품id7', '금도끼', 10000, 70, 'abc7.jpg', '상품정보7', 11, 17);

delete FROM product



SELECT * FROM product_option
--상품 옵션TB                        // 옵션아이디                옵션네임            옵션서브네임    수량       추가가격   , 상품ID
insert into product_option values (option_id_seq.nextval, '사이즈/색상', '250/흰색', 10, 1000, '상품id1');
insert into product_option values (option_id_seq.nextval, '사이즈/색상', '240/검정색', 5, 5000, '상품id2');
insert into product_option values (option_id_seq.nextval, '사이즈/색상', '230/흰색', 10, 3000, '상품id3');
insert into product_option values (option_id_seq.nextval, '사이즈/색상', '220/흰색', 10, 0, '상품id4');
insert into product_option values (option_id_seq.nextval, '사이즈/색상', '210/검정색', 5, 0, '상품id5');
insert into product_option values (option_id_seq.nextval, '사이즈/색상', '260/흰색', 10, 2000, '상품id6');
insert into product_option values (option_id_seq.nextval, '사이즈/색상', '270/흰색', 10, 3000, '상품id7');


-------------- 나의주문
select * FROM member;
SELECT * FROM orders 
select * FROM seller;    
select * FROM product;  
SELECT * FROM order_product
SELECT * FROM product_option










SELECT      o.orders_no , o.orders_receiver , o.orders_phone ,
			o.orders_zipcode , o.orders_address , o.orders_sub_address ,
			o.orders_total_price , o.orders_payment , o.orders_request ,
			o.payment_status , o.orders_status ,
			o.member_id  ,
			
			op.order_amount  , op.orders_no ,  op.product_id  ,op.option_id , op.seller_store_no ,
			
			p.product_Id, p.product_name, p.product_price, p.product_stock, 
			p.product_main_image, p.product_info, p.product_like, 
			p.seller_store_no ,
			
			s.seller_store_no, s.seller_store_name, s.seller_tax_id, s.seller_industry, 
			s.seller_sub_industry, s.seller_zipcode, s.seller_address, s.seller_sub_address, 
			s.seller_store_image, s.seller_product1, s.seller_product2, s.seller_product3, 
			s.seller_introduction, s.seller_assign, s.member_id  , 
		
			po.option_id , po.option_name , po.option_sub_name , po.option_stock , po.option_add_price , po.product_id 
			
	FROM   orders o ,  order_product op , product p  ,seller s  , product_option po
	
	WHERE  o.member_id =  'admin@admin.com'  
	AND    o.orders_no =  op.orders_no
	AND    op.product_id =  p.product_Id
	AND    op.seller_store_no =  s.seller_store_no
	AND    op.option_id  =  po.option_id
	AND     p.product_Id = po.product_id 
	
	
	AND    o.orders_status IN ( 0,1,2,3,4)	 
	

	